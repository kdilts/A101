<head>
	<script language=javascript>
var canvas; var gfx;
var cwidth; var cheight;
var centerX = .666*800; var centerY = .17*600;

var pulldown1; var pulldown2;
var angleSlider; var separationSlider;
var buttons = [];

var currentStar1 = 'A'; var currentStar2 = 'F';
var currentTheta = 0;  var step = .01;

var currentAngle = 10; var currentSeparation = '12'

var solarRad = 7;

var data = {
	B:[ '28000 K', '4.9 Solar Radii', 'rgb(111,255,245)' ],
	A:[ '10000 K', '3.0 Solar Radii', 'rgb(0,200,246)'  ],
	F:[ '7500 K', '1.5 Solar Radii', 'rgb(39,255,220)'  ],
	G:[ '6000 K', '1.1 Solar Radii', 'rgb(251,255,80)'  ],
	K:[ '5000 K', '0.9 Solar Radii', 'rgb(255,126,32)'  ],
	M:[ '3500 K', '0.8 Solar Radii', 'rgb(255,22,25)'  ]
};

window.onload = function(){
	canvas = document.createElement('canvas');
	canvas.setAttribute('style','position:absolute; left:0; top:0; z-index:-1');
	cwidth = canvas.width = window.innerWidth;
	cheight = canvas.height = window.innerHeight;
	document.body.appendChild(canvas);
	gfx = canvas.getContext('2d');

	pulldown1 = document.getElementById('pulldown1');
	pulldown2 = document.getElementById('pulldown2');

	angleSlider = document.getElementById('angleSlider');
	separationSlider = document.getElementById('separationSlider');

	buttons[0] = document.getElementById('submitButton');
	buttons[1] = document.getElementById('clearButton');
	buttons[2] = document.getElementById('pauseButton');

	submitButton.onclick = function(){
		currentStar1 = pulldown1.value;
		currentStar2 = pulldown2.value;

		currentAngle = angleSlider.value;
		currentSeparation = separationSlider.value;
		currentTheta = 0;
	}

	pauseButton.onclick = function(){}

	clearButton.onclick = function(){}

	angleSlider.value = currentAngle; separationSlider.value = 12;
	pulldown1.value = 'A'; pulldown2.value = 'F';

	setInterval(render,1000/60);
}

window.onresize = function(){ render(); }

render = function(){
	cwidth = canvas.width = window.innerWidth;
	cheight = canvas.height = window.innerHeight;

	gfx.clearRect(0,0,cwidth,cheight);

	drawStars();

	drawGraph();
	drawStats();

	currentTheta += step;
	if(currentTheta >= Math.PI*2){ currentTheta = 0; }

}

drawStats = function(){
	var offsetX = 5; var offsetY = 300; var rowSize = 16;
	gfx.fillStyle = gfx.strokeStyle = 'black';
	gfx.font = '14px verdana';
	gfx.fillText('Current Values:',offsetX,offsetY-rowSize);
	gfx.fillText('Star 1:',offsetX+10,offsetY+rowSize);
	gfx.fillText('Type: '+currentStar1,offsetX+20,offsetY+rowSize*2);
	gfx.fillText('T: '+data[currentStar1][0],offsetX+20,offsetY+rowSize*3);
	gfx.fillText('R: '+data[currentStar1][1],offsetX+20,offsetY+rowSize*4);
	gfx.fillText('Star 2:',offsetX+10,offsetY+rowSize*6);
	gfx.fillText('Type: '+currentStar2,offsetX+20,offsetY+rowSize*7);
	gfx.fillText('T: '+data[currentStar2][0],offsetX+20,offsetY+rowSize*8);
	gfx.fillText('R: '+data[currentStar2][1],offsetX+20,offsetY+rowSize*9);

	gfx.fillText('Angle of Inclination: ' + currentAngle + ' degrees',offsetX,offsetY+rowSize*11);
	gfx.fillText('Separation: ' + currentSeparation + ' Solar Radii',offsetX,offsetY+rowSize*12);
}

drawStars = function(){
	
	
	if(currentSeparation < (parseFloat(data[currentStar1][1]) + parseFloat(data[currentStar2][1]))){

		currentSeparation = Math.ceil(parseFloat(data[currentStar1][1]) + parseFloat(data[currentStar2][1]));
	}

	// center point
	gfx.fillStyle = gfx.strokeStyle = 'black';
	gfx.beginPath(); gfx.arc(centerX,centerY,2,0,Math.PI*2); gfx.fill(); gfx.stroke();

	if(currentTheta > 3*Math.PI/2 || currentTheta < Math.PI/2){
		drawStar1();
		drawStar2();
	}else{
		drawStar2();
		drawStar1();
	}
}

drawStar1 = function(){
	// star 1
	gfx.fillStyle = gfx.strokeStyle = data[currentStar1][2];
	gfx.beginPath();
	gfx.arc(
		centerX + solarRad*currentSeparation/2 * Math.sin(currentTheta),
		centerY + solarRad*currentSeparation/2 * Math.cos(currentTheta) * Math.sin(currentAngle),
		parseFloat(data[currentStar1][1])*solarRad,
		0,
		Math.PI*2
	);
	gfx.fill(); gfx.stroke();
}

drawStar2 = function(){
	// star 2
	gfx.fillStyle = gfx.strokeStyle = data[currentStar2][2];
	gfx.beginPath();
		gfx.arc(
		centerX + solarRad*currentSeparation/2 * Math.sin(currentTheta+Math.PI),
		centerY + solarRad*currentSeparation/2 * Math.cos(currentTheta+Math.PI) * Math.sin(currentAngle),
		parseFloat(data[currentStar2][1])*solarRad,
		0,
		Math.PI*2
	);
	gfx.fill(); gfx.stroke();
}

drawGraph = function(){
	var origX = 270; var origY = 550;
	
	gfx.strokeStyle = 'black';
	gfx.strokeRect(origX,origY-350,500,350);
	gfx.fillStyle = 'white'
	gfx.fillRect(origX,origY-350,500,350);
	
	gfx.fillStyle = 'black'
	gfx.font = '16px verdana'
	gfx.fillText('Theta',origX+225,origY+40);
	gfx.fillText('L',origX-45,origY-185);

	for(var x = 0; x < 7; x++){ gfx.fillText(''+(60*x), origX+80*x, origY+20); }
	for(var y = 0; y < 5; y++){ gfx.fillText((''+(3.6+.1*y)).substr(0,3), origX-32, origY-350/4.2*y); }

	for(var x = 1; x < 10; x++){
		drawLine(origX+x*50,origY,origX+x*50,origY-10);
		drawLine(origX+x*50,origY-350,origX+x*50,origY-340);
	}
	
	for(var y = 1; y < 7; y++){
		drawLine(origX,origY-y*50,origX+10,origY-y*50);
		drawLine(origX+490,origY-y*50,origX+500,origY-y*50);
	}

}

drawLine = function(x1,y1,x2,y2){
	gfx.beginPath();
	gfx.moveTo(x1,y1);
	gfx.lineTo(x2,y2);
	gfx.stroke();
}

lerp = function(oldMin,oldMax,oldVal,newMin,newMax){
	return (oldVal-oldMin)/(oldMax-oldMin)*(newMax-newMin)+newMin;
}

dist = function(v1,v2){ return mag(add(v1,neg(v2))); }

vec2 = function(x,y){ this.x = x; this.y = y; }
add = function(v1, v2){ return new vec2(v1.x+v2.x, v1.y+v2.y); }
sub = function(v1, v2){ return new vec2(v1.x-v2.x, v1.y-v2.y); }
neg = function(v){ return new vec2(-v.x, -v.y); }
mag = function(v){ return Math.sqrt(Math.pow(v.x,2) + Math.pow(v.y,2)); }
dot = function(v1,v2){ return v1.x*v2.x + v1.y*v2.y; }
unit = function(v){ return new vec2(v.x/mag(v), v.y/mag(v)); }
mult = function(v,s){ return new vec2(v.x*s, v.y*s); }

	</script>
</head>
<body bgcolor="white">
	<form>
			<input type='button' id='submitButton' value='Enter Values'>
			<input type='button' id='clearButton' value='Clear Graph'>
			<input type='button' id='pauseButton' value='Pause'>
			<br></br>
			<b1>Angle: </b1>
			<input type = 'range' id = 'angleSlider' min='0' max = '90'></input>
			<br></br>
			<b1>Separation: </b1>
			<input type = 'range' id = 'separationSlider' min='2' max = '25'></input>
			<br></br>
			<b1>Star 1: </b1><select id='pulldown1'>
				<option value = "B">B</option>
				<option value = "A">A</option>
				<option value = "F">F</option>
				<option value = "G">G</option>
				<option value = "K">K</option>
				<option value = "M">M</option>
			</select>
			&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;
			<b1>Star 2:</b1><select id='pulldown2'>
				<option value = "B">B</option>
				<option value = "A">A</option>
				<option value = "F">F</option>
				<option value = "G">G</option>
				<option value = "K">K</option>
				<option value = "M">M</option>
			</select>
		</form>
</body>